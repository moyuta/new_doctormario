<!DOCTYPE html>
<html>

<head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://doctormario.herokuapp.com/socket.io/socket.io.js"></script>
  <link rel="stylesheet" type="text/css" href="/style.css">

  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width">
  <title>doctor mario</title>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-125784262-5"></script>
  <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-125784262-5');
</script>


</head>
<body>
  <div class="header">
    <h1 class ="ribon"><span style="color:white">ãƒ‰ã‚¯ã‚¿ãƒ¼ãƒãƒªã‚ªã€€ãƒ¯ãƒ¼ãƒ«ãƒ‰æ”»ç•¥ã‚µã‚¤ãƒˆ</span></h1>
  </div>

<nav>
    <ul class="primary">
      <li>
        <a href="/">Home</a>
      </li>
      <li>
        <a href="progress">é€²ã‚æ–¹</a>
        <ul class="sub">
          <li><a href="progress#stage">ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ¢ãƒ¼ãƒ‰ã‚’é€²ã‚ã‚‹</a></li>
          <li><a href="progress#gachasukauto">ã‚¬ãƒãƒ£ã‚’å¼•ãã‚­ãƒ£ãƒ©ã‚’ã‚¹ã‚«ã‚¦ãƒˆã™ã‚‹</a></li>
          <li><a href="progress#heartkaihuku">ãƒãƒ¼ãƒˆã‚’å›å¾©ã™ã‚‹</a></li>
        </ul>
      </li>
      <li>
        <a href="chapter">æ”»ç•¥</a>
      </li>
      <li>
        <a href="character">ã‚­ãƒ£ãƒ©</a>
        <ul class="sub">
          <li><a href="character#characterlist">ã‚­ãƒ£ãƒ©ä¸€è¦§</a></li>
          <li><a href="character#strongestcharacter">æœ€å¼·ã‚­ãƒ£ãƒ©ãƒ©ãƒ³ã‚­ãƒ³ã‚°</a></li>
        </ul>
      </li>
      <li>
        <a href="gacha">ã‚¹ã‚«ã‚¦ãƒˆ</a>
        <ul class="sub">
          <li><a href="gacha#whatisgacha">ã‚¹ã‚«ã‚¦ãƒˆã¨ã¯ï¼Ÿ</a></li>
          <li><a href="gacha#timing">ã‚¿ã‚¤ãƒŸãƒ³ã‚°</a></li>
        </ul>
      </li>

      <li>
        <a href="item">ã‚¢ã‚¤ãƒ†ãƒ </a>
        <ul class="sub">
          <li><a href="item#itemabout">ã‚¢ã‚¤ãƒ†ãƒ ã¨ã¯ï¼Ÿ</a></li>
          <li><a href="item#itemhowto">ç¨®é¡ã¨ä½¿ã„æ–¹</a></li>
        </ul>
      </li>
      <li>
        <a href="heart">ãƒãƒ¼ãƒˆ</a>
        <ul class="sub">
          <li><a href="heart#heartabout">ãƒãƒ¼ãƒˆã¨ã¯ï¼Ÿ</a></li>
          <li><a href="heart#heartkaihuku">å›å¾©æ–¹æ³•</a></li>
        </ul>
      </li>
      <li>
        <a href="daiyamond">ãƒ€ã‚¤ãƒ¤</a>
        <ul class="sub">
          <li><a href="daiyamond#daiyahowto">ãƒ€ã‚¤ãƒ¤ã¨ã¯ï¼Ÿ</a></li>
          <li><a href="daiyamond#daiyaget">å…¥æ‰‹æ–¹æ³•</a></li>
        </ul>
      </li>
      <li>
        <a href="board">æ²ç¤ºæ¿</a>
      </li>
    </ul>
  </nav>
  <hr />

  <div class = "daimei">
    <h2>ãƒ•ãƒ¬ãƒ³ãƒ‰å‹Ÿé›†æ²ç¤ºæ¿</h2>
  </div>
  <h2 class = "check">ç¦æ­¢äº‹é …</h2>
  <ul>
    <li>èª¹è¬—ãƒ»ä¸­å‚·å«ã‚€æ›¸ãè¾¼ã¿</li>
    <li>å‡ºä¼šã„ç›®çš„ãƒ»å…¬åºè‰¯ä¿—ã«åã™ã‚‹æ›¸ãè¾¼ã¿</li>
    <li>ä»–ã‚µã‚¤ãƒˆã‚„ã‚¢ãƒ—ãƒªã®å®£ä¼</li>
    <li>ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå£²è²·ç›®çš„ã®æ›¸ãè¾¼ã¿</li>
  </ul>
  <div class = "text">
    <p>ç¦æ­¢äº‹é …ã«å½“ã¦ã¯ã¾ã‚‹æ›¸ãè¾¼ã¿ãŒã‚ã£ãŸå ´åˆã€äºˆå‘Šãªãå‰Šé™¤ã‚„IPè¦åˆ¶ã‚’è¡Œã†å ´åˆãŒã”ã–ã„ã¾ã™ã€‚</p>
  </div>

  <form name="user">
    <input type="text" name="name" placeholder="ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
    <input type="button" value="æ±ºå®š" onclick="makename()">
  </form>

  <div id="username"></div>

<form name="chat">
<textarea name="message" id="tex" rows="4" cols="40" placeholder="æ›¸ãè¾¼ã‚€"></textarea>
<input type="button" value="é€ä¿¡" onclick="socket()">
<input type="button" value="æ›´æ–°" onclick="up()">
</form>


      <div id ="list"></div>

  <div class="footer">
    <hr/>
    <a href="/" class="btn-circle-fishy">HomeğŸ </a>
  </div>


</body>
<script>
up() ;
let nowname = window.sessionStorage.getItem(['user_name']) ;
 if(nowname ==""){
     nowname = "åç„¡ã—" ;
     window.sessionStorage.setItem(['user_name'],[nowname]) ;
   }
$("#username").append("<h3>ã‚ˆã†ã“ã["+nowname+"]ã•ã‚“</h3>");
let gettime = function(){
    let dt = new Date() ;
    let year = dt.getFullYear() ;
    let month = dt.getMonth() + 1 ;
    let date = dt.getDate() ;
    let hours = dt.getHours() ;
    let minutes = dt.getMinutes() ;
    let seconds = dt.getSeconds() ;
    let dateT = ["æ—¥","æœˆ","ç«","æ°´","æœ¨","é‡‘","åœŸ"] ;
    let day = dateT[dt.getDay()] ;

    let time = year + "/" + month + "/" + date + "(" + day + ")" + hours + "æ™‚:" + minutes + "åˆ†:" + seconds + "ç§’" ;
    return time ;
}

function up(){
  $("#list").empty();
  let socket = io.connect();
  socket.emit("update","update") ;
  socket.on("msg_list",(list)=>{
      for(let i =0 ; i < list.length ; i++ ){

        $("#list").prepend("<p><span style='color:blue'>"+list[i].name+"</span>["+ list[i].date+"]<br>"+list[i].chat + "</p>") ;
      }
  })
}


  let reset_target = document.getElementById("tex");

function socket(){
   $("#list").empty();
   let usname = window.sessionStorage.getItem(['user_name']) ;
   if(usname ==""){
     usname = "åç„¡ã—" ;
   }
  let socket = io.connect();
  let chattime = gettime() ;
  let msg = $(`textarea[name="message"]`).val() ;
  console.log(msg)
  socket.emit("msg_from_client",{
      date : chattime,
      chat : msg ,
      name : usname
    });
    socket.emit("update","update") ;
   socket.on("msg_list",(list)=>{
       for(let i =0 ; i < list.length ; i++ ){
         $("#list").prepend("<p><span style='color:blue'>"+list[i].name+"</span>["+ list[i].date+"]<br>"+list[i].chat + "</p>");
       }
   })
   reset_target.value = '';
}


function makename(){
   $("#username").empty();
let form_name = $(`input[name="name"]`).val() ;
window.sessionStorage.setItem(['user_name'],[form_name]) ;
nowname = window.sessionStorage.getItem(['user_name']) ;
 if(nowname ==""){
     nowname = "åç„¡ã—" ;
     window.sessionStorage.setItem(['user_name'],[nowname]) ;
   }
$("#username").append("<h3>ã‚ˆã†ã“ã["+nowname+"]ã•ã‚“</h3>");
}


</script>

</html>
